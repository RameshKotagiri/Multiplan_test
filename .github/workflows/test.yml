package terraform

deny[msg] {
    resource := input.plan.resource_changes[_]
    resource.type == "oci_objectstorage_bucket"
    resource.change.actions[_] == "create"
    not "kms_key_id" in object.keys(resource.change.after)
    msg := sprintf("Bucket '%s' does not have kms_key_id defined", [resource.change.after.name])
}

deny[msg] {
    resource := input.plan.resource_changes[_]
    resource.type == "oci_objectstorage_bucket"
    resource.change.actions[_] == "create"
    resource.change.after.kms_key_id == ""
    msg := sprintf("Bucket '%s' has an empty kms_key_id", [resource.change.after.name])
}
